#!/bin/bash

lib=$(dirname $0)/../../lib/std.shlib; [ -f ${lib} ] && . ${lib} || { echo "${lib} not found" 1>&2; exit 1; }
lib=$(dirname $0)/../../lib/em.shlib; [ -f ${lib} ] && . ${lib} || { echo "${lib} not found" 1>&2; exit 1; }
lib=$(dirname $0)/../../lib/linux.shlib; [ -f ${lib} ] && . ${lib} || { echo "${lib} not found" 1>&2; exit 1; }
lib=$(dirname $0)/lib/overlays.shlib; [ -f ${lib} ] && . ${lib} || { echo "${lib} not found" 1>&2; exit 1; }
lib=$(dirname $0)/lib/$(basename $0).shlib; [ -f ${lib} ] && . ${lib}

#
# dependencies
#

$(dirname $0)/basic $@

#
# overlay
#

process-overlay-arguments $@
overlay-preconditions
is-overlay-applied && { info "$(basename $0) overlay already applied"; exit 0; }

install-java
debug "post install JAVA_HOME: ${JAVA_HOME}"

update-user-environment-for-java root
update-user-environment-for-java ec2-user

exit 0





